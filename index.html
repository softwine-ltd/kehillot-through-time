 <!DOCTYPE html>
<html>

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C58QB49Z2S"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-C58QB49Z2S');
    </script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Primary Meta Tags -->
    <title>Jewish Demographics & Historical Communities Map | Interactive Timeline</title>
    <meta name="title" content="Jewish Demographics & Historical Communities Map | Interactive Timeline">
    <meta name="description"
        content="Explore interactive maps of Jewish communities worldwide, tracking demographic changes and migration patterns throughout history. Discover kehillot and Jewish diaspora population data across time.">
    <meta name="keywords"
        content="Jewish demographics, Jewish history, population maps, Jewish communities, kehillot, Jewish diaspora, historical maps, Jewish migration, interactive timeline, Jewish geography, demographic changes, Jewish population data">

    <!-- Author and Copyright -->
    <meta name="author" content="Bezalel Brandwine and Ofer Manela">
    <meta name="copyright" content="Softwine LTD">

    <!-- Additional Meta -->
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://kehilot.softwine.net/">
    <meta property="og:title" content="Jewish Demographics & Historical Communities Map">
    <meta property="og:description"
        content="Explore interactive maps of Jewish communities worldwide, tracking demographic changes and migration patterns throughout history.">
    <meta property="og:image" content="https://kehilot.softwine.net/jewish-history-icon.svg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://kehilot.softwine.net/">
    <meta property="twitter:title" content="Jewish Demographics & Historical Communities Map">
    <meta property="twitter:description"
        content="Explore interactive maps of Jewish communities worldwide, tracking demographic changes and migration patterns throughout history.">
    <meta property="twitter:image" content="https://kehilot.softwine.net/jewish-history-icon.svg">

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": [{
            "@language": "en",
            "@value": "Jewish Demographics & Historical Communities Map"
          }, {
            "@language": "he",
            "@value": "מפת דמוגרפיה וקהילות יהודיות היסטוריות"
          }],
          "description": [{
            "@language": "en",
            "@value": "Interactive mapping platform for exploring Jewish communities..."
          }, {
            "@language": "he",
            "@value": "פלטפורמת מיפוי אינטראקטיבית לחקר קהילות יהודיות..."
          }],
        "keywords": "Jewish demographics, Jewish history, population maps, Jewish communities, kehillot, Jewish diaspora, historical maps, Jewish migration, interactive timeline, Jewish geography, demographic changes, Jewish population data",
        "url": "https://kehilot.softwine.net",
        "publisher": {
            "@type": "Organization",
            "name": "Softwine LTD",
            "logo": {
                "@type": "ImageObject",
                "url": "https://softwine.net/default.svg"
            }
        }
    }
    </script>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kehilot.softwine.net/">
    <link rel="icon" type="image/svg+xml" href="jewish-history-icon.svg">

    <!-- Leaflet map CSS + JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">

    <!-- Timeline -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.js"></script>
    <!-- map markers -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.css" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.Default.css" />

    <script src="i18n.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="helpers.js"></script>
    <link rel="stylesheet" href="./styles.css" />
</head>

<body class="bg-gray-50">
    <div class="bg-yellow-50 border-l-4 border-yellow-400 py-2 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="flex">
                <div class="ml-3">
                    <p class="text-base text-yellow-700" data-i18n="workInProgress">
                        <strong>Work in Progress:</strong> This visualization is under development. The data has not been verified and some numbers are estimates or approximations for demonstration purposes.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-1 lg:py-4 flex justify-between items-center">
            <h1 class="text-base lg:text-xl font-semibold text-gray-900" data-i18n="ui.title">Jewish Demographics & Historical Communities Map</h1>
            <div class="flex gap-1 lg:gap-4">
                <button id="aboutButton" class="px-2 py-1 lg:px-4 lg:py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-xs lg:text-base" data-i18n="ui.about">
                    About
                </button>
                <button id="startTourButton" class="px-2 py-1 lg:px-4 lg:py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-xs lg:text-base" data-i18n="ui.startTour">
                    Start Tour
                </button>
                <button id="printButton" class="px-2 py-1 lg:px-4 lg:py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-1 lg:gap-2 text-xs lg:text-base">
                    <svg class="w-3 h-3 lg:w-4 lg:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    <span data-i18n="ui.print">Print</span>
                </button>
                <button id="suggestDataButton" class="px-2 py-1 lg:px-4 lg:py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-xs lg:text-base" data-i18n="ui.suggestData">
                    Suggest Data
                </button>
            </div>
        </div>
    </header>

    <div class="map-container">
        <div class="floating-icon">
            <img src="jewish-history-icon.svg" alt="Jewish History Interactive Visualization Icon"
                title="Interactive Jewish History Visualization">
        </div>

        <div class="bg-white border-t border-gray-200">
            <div class="timeline-section py-3 lg:py-6">
                <div class="flex flex-wrap items-center gap-1 sm:gap-2 lg:gap-4 mb-2 lg:mb-4">
                    <div class="relative flex-shrink-0">
                        <button id="playButton" class="p-1.5 lg:p-2 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors flex-shrink-0">
                            <svg class="w-4 h-4 lg:w-5 lg:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                            </svg>
                        </button>
                        <div id="playButtonArrow" class="absolute -top-12 left-1/2 transform -translate-x-1/2 flex flex-col items-center gap-1 animate-pulse">
                            <span class="text-red-500 font-bold text-sm whitespace-nowrap" data-i18n="ui.pressHere">Press Here</span>
                            <svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                        </div>
                    </div>
                    <div id="year-display" class="text-xs lg:text-sm font-medium text-gray-900 min-w-24 sm:min-w-32 lg:min-w-[28rem] text-left whitespace-nowrap"></div>
                    <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                        <label for="speedControl" class="text-xs lg:text-sm text-gray-600 hidden lg:inline" data-i18n="ui.speed">Speed:</label>
                        <input type="range" id="speedControl" min="1" max="20" value="4" class="w-16 sm:w-20 lg:w-24 h-1.5 lg:h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        <span id="speedDisplay" class="text-xs lg:text-sm text-gray-500 w-4 sm:w-6 lg:w-8">4x</span>
                    </div>
                    <div id="year-steps" class="flex items-center gap-0.5 sm:gap-1 flex-shrink-0">
                        <button data-step="-10" class="px-1 py-0.5 lg:px-2 lg:py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">-10</button>
                        <button data-step="-5" class="px-1 py-0.5 lg:px-2 lg:py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">-5</button>
                        <button data-step="-1" class="px-1 py-0.5 lg:px-2 lg:py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">-1</button>
                        <button data-step="1" class="px-1 py-0.5 lg:px-2 lg:py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">+1</button>
                        <button data-step="5" class="px-1 py-0.5 lg:px-2 lg:py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">+5</button>
                        <button data-step="10" class="px-1 py-0.5 lg:px-2 lg:py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200">+10</button>
                    </div>
                    <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                        <label for="citySearch" class="text-xs lg:text-sm text-gray-600 hidden lg:inline" data-i18n="ui.search">Search:</label>
                        <input type="text" id="citySearch" data-i18n="ui.cityPlaceholder" placeholder="City..." class="text-xs lg:text-sm border border-gray-300 rounded-md px-1.5 lg:px-2 py-0.5 lg:py-1 bg-white min-w-0 w-24 sm:w-32 lg:w-36">
                        <button id="clearSearch" class="text-gray-400 hover:text-gray-600 text-xs lg:text-sm" data-i18n="ui.clearSearch" title="Clear search">✕</button>
                    </div>
                    <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                        <label for="tileSelector" class="text-xs lg:text-sm text-gray-600 hidden lg:inline" data-i18n="ui.labels">Labels:</label>
                        <select id="tileSelector" class="text-xs lg:text-sm border border-gray-300 rounded-md px-1 lg:px-2 py-0.5 lg:py-1 bg-white min-w-0">
                            <option value="osm" data-i18n="mapLabels.local">Local</option>
                            <option value="cartodb" data-i18n="mapLabels.englishCartoDB">English (CartoDB)</option>
                            <option value="maptiler" data-i18n="mapLabels.englishMapTiler">English (MapTiler)</option>
                            <option value="osm-france" data-i18n="mapLabels.french">French</option>
                            <option value="osm-de" data-i18n="mapLabels.german">German</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                        <label for="mapCenterSelector" class="text-xs lg:text-sm text-gray-600 hidden lg:inline" data-i18n="ui.view">View:</label>
                        <select id="mapCenterSelector" class="text-xs lg:text-sm border border-gray-300 rounded-md px-1 lg:px-2 py-0.5 lg:py-1 bg-white min-w-0">
                            <option value="europe" data-i18n="mapLabels.europeMiddleEast">Europe & Middle East</option>
                            <option value="americas" data-i18n="mapLabels.americas">Americas</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-1 sm:gap-2 flex-shrink-0">
                        <label for="clusterRadius" class="text-xs lg:text-sm text-gray-600 hidden lg:inline" data-i18n="ui.clustering">Clustering:</label>
                        <input type="range" id="clusterRadius" min="10" max="200" value="80" 
                               class="w-16 sm:w-20 lg:w-24 h-1.5 lg:h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        <span id="clusterValue" class="text-xs lg:text-sm text-gray-500 w-4 sm:w-6 lg:w-8">80px</span>
                    </div>
                </div>
                
                <div id="timeline" class="relative h-2 bg-gray-200 rounded-full">
                    <!-- <div class="absolute left-1/4 h-full w-1/4 bg-blue-500 rounded-full"></div> -->
                </div>
                
                <!-- Historical Periods Timeline -->
                <div id="historical-periods" class="mt-3 mb-2">
                    <div class="relative h-4 bg-gray-100 rounded-full">
                        <!-- Biblical Era: 1312 to 586 BCE (726 years) = 21.8% -->
                        <div class="period-bar absolute left-0 top-0 h-full rounded-l-full" data-period="Biblical Era" style="background-color: #8B4513; width: 21.8%;" title="Biblical Era (1312-586 BCE)">
                            <span class="period-text" data-i18n="historicalPeriods.biblicalEra">Biblical Era</span>
                        </div>
                        <!-- Second Temple: 586 BCE to 70 CE (656 years) = 19.7% -->
                        <div class="period-bar absolute" data-period="Second Temple" style="background-color: #B8860B; left: 21.8%; width: 19.7%;" title="Second Temple (586 BCE - 70 CE)">
                            <span class="period-text" data-i18n="historicalPeriods.secondTemple">Second Temple</span>
                        </div>
                        <!-- Talmudic Era: 70 to 500 CE (430 years) = 12.9% -->
                        <div class="period-bar absolute" data-period="Talmudic Era" style="background-color: #228B22; left: 41.5%; width: 12.9%;" title="Talmudic Era (70-500 CE)">
                            <span class="period-text" data-i18n="historicalPeriods.talmudicEra">Talmudic Era</span>
                        </div>
                        <!-- Medieval: 500 to 1500 CE (1000 years) = 30.0% -->
                        <div class="period-bar absolute" data-period="Medieval" style="background-color: #4169E1; left: 54.4%; width: 30.0%;" title="Medieval (500-1500 CE)">
                            <span class="period-text" data-i18n="historicalPeriods.medieval">Medieval</span>
                        </div>
                        <!-- Early Modern: 1500 to 1800 CE (300 years) = 9.0% -->
                        <div class="period-bar absolute" data-period="Early Modern" style="background-color: #9370DB; left: 84.4%; width: 9.0%;" title="Early Modern (1500-1800 CE)">
                            <span class="period-text" data-i18n="historicalPeriods.earlyModern">Early Modern</span>
                        </div>
                        <!-- Modern: 1800 to 2025 CE (225 years) = 6.7% -->
                        <div class="period-bar absolute right-0 top-0 h-full rounded-r-full" data-period="Modern" style="background-color: #FF6347; width: 6.7%;" title="Modern (1800-2025 CE)">
                            <span class="period-text" data-i18n="historicalPeriods.modern">Modern</span>
                        </div>
                    </div>
                    <div class="relative mt-1 text-xs text-gray-500">
                        <span class="absolute left-0">1312 BCE</span>
                        <span class="absolute" style="left: 21.8%; transform: translateX(-50%);">586 BCE</span>
                        <span class="absolute" style="left: 41.4%; transform: translateX(-50%);">70 CE</span>
                        <span class="absolute" style="left: 54.3%; transform: translateX(-50%);">500 CE</span>
                        <span class="absolute" style="left: 84.3%; transform: translateX(-50%);">1500 CE</span>
                        <span class="absolute" style="left: 93.3%; transform: translateX(-50%);">1800 CE</span>
                        <span class="absolute right-0">2025 CE</span>
                    </div>
                </div>
                
            </div>
        </div>

        <div id="map" class="mt-4"></div>
    </div>

    <!-- About Modal -->
    <div id="aboutModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900" data-i18n="about.title">About This Project</h2>
                    <button id="closeAboutModal" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">
                        ×
                    </button>
                </div>
                
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3" data-i18n="about.overview.title">Project Overview</h3>
                        <p class="text-gray-700 leading-relaxed" data-i18n="about.overview.description">
                            This interactive visualization explores the demographic history of Jewish communities worldwide, 
                            tracking population changes and migration patterns from ancient times to the present. The map 
                            displays Jewish communities (kehillot) with their estimated populations at different historical 
                            periods, allowing users to understand the ebb and flow of Jewish life across centuries.
                        </p>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3" data-i18n="about.features.title">Features</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-2" data-i18n="about.features.items">
                            <li><strong>Interactive Timeline:</strong> Navigate through 3,400+ years of Jewish history</li>
                            <li><strong>Population Visualization:</strong> Community markers show population size and confidence levels</li>
                            <li><strong>Historical Events:</strong> Major events and persecutions that shaped Jewish demographics</li>
                            <li><strong>Migration Patterns:</strong> Visual representation of Jewish diaspora movements</li>
                            <li><strong>Multilingual Support:</strong> Place names in local languages and English</li>
                            <li><strong>Educational Resources:</strong> Links to historical sources and references</li>
                        </ul>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3" data-i18n="about.dataSources.title">Data Sources</h3>
                        <p class="text-gray-700 leading-relaxed" data-i18n="about.dataSources.description">
                            The data combines historical records, archaeological findings, demographic studies, and scholarly 
                            research. Population estimates are based on available historical sources and may include approximations 
                            for demonstration purposes. Sources include academic publications, historical documents, and 
                            established demographic databases.
                        </p>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3" data-i18n="about.howToUse.title">How to Use</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-2" data-i18n="about.howToUse.items">
                            <li>Use the timeline slider to navigate through different time periods</li>
                            <li>Click on community markers to see detailed information</li>
                            <li>Hover over timeline markers to learn about historical events</li>
                            <li>Use the play button to animate through time automatically</li>
                            <li>Switch between different map views and language options</li>
                        </ul>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3" data-i18n="about.credits.title">Credits</h3>
                        <p class="text-gray-700 leading-relaxed">
                            <strong data-i18n="about.credits.developedBy">Developed by:</strong> Bezalel Brandwine and Ofer Manela<br>
                            <strong data-i18n="about.credits.organization">Organization:</strong> Softwine LTD<br>
                            <strong data-i18n="about.credits.contact">Contact:</strong> <a href="mailto:kehilot.history@gmail.com" class="text-blue-600 hover:text-blue-800 underline">kehilot.history@gmail.com</a><br>
                            <strong data-i18n="about.credits.mapData">Map Data:</strong> OpenStreetMap contributors<br>
                            <strong data-i18n="about.credits.timelineTechnology">Timeline Technology:</strong> noUiSlider<br>
                            <strong data-i18n="about.credits.mappingLibrary">Mapping Library:</strong> Leaflet with MarkerCluster
                        </p>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
                        <p class="text-yellow-800 text-sm" data-i18n="about.note">
                            <strong>Note:</strong> This visualization is under development. Some data points are estimates 
                            or approximations for demonstration purposes and have not been fully verified. We welcome 
                            feedback and corrections from historians and researchers.
                        </p>
                    </div>
                </div>

                <div class="mt-8 flex justify-end">
                    <button id="closeAboutModalBtn" class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors" data-i18n="ui.close">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Language Selection Modal -->
    <div id="languageModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-md w-full">
            <div class="p-6">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2" data-i18n="tour.selectLanguage">Select Tour Language</h2>
                    <p class="text-gray-600" data-i18n="tour.selectLanguageDescription">Choose your preferred language for the interactive tour</p>
                </div>
                
                <div class="space-y-4">
                    <button id="selectEnglish" class="w-full p-4 border-2 border-blue-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors text-left">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                <span class="text-blue-600 font-bold">EN</span>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900">English</div>
                                <div class="text-sm text-gray-600">Interactive tour in English</div>
                            </div>
                        </div>
                    </button>
                    
                    <button id="selectHebrew" class="w-full p-4 border-2 border-blue-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors text-left">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                <span class="text-blue-600 font-bold">עב</span>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900">עברית</div>
                                <div class="text-sm text-gray-600">סיור אינטראקטיבי בעברית</div>
                            </div>
                        </div>
                    </button>
                    
                    <button id="selectFrench" class="w-full p-4 border-2 border-blue-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors text-left">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                <span class="text-blue-600 font-bold">FR</span>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900">Français</div>
                                <div class="text-sm text-gray-600">Visite interactive en français</div>
                            </div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tour Modal -->
    <div id="tourModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 id="tourTitle" class="text-2xl font-bold text-gray-900" data-i18n="tour.title">Interactive Tour</h2>
                    <div class="flex items-center gap-4">
                        <span id="tourProgress" class="text-sm text-gray-600">Step 1 of 8</span>
                        <button id="closeTourModal" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">
                            ×
                        </button>
                    </div>
                </div>
                
                <div id="tourContent" class="space-y-6">
                    <!-- Tour content will be dynamically populated -->
                </div>

                <div class="mt-8 flex justify-between">
                    <button id="prevTourStep" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                        <span id="prevTourText" data-i18n="ui.previous">Previous</span>
                    </button>
                    <div class="flex gap-2">
                        <button id="skipTour" class="px-4 py-2 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors" data-i18n="ui.skipTour">
                            Skip Tour
                        </button>
                        <button id="nextTourStep" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors" data-i18n="ui.next">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tour Overlay -->
    <div id="tourOverlay" class="fixed inset-0 pointer-events-none z-40 hidden">
        <div id="tourHighlight" class="absolute border-4 border-blue-500 rounded-lg shadow-lg bg-blue-500 bg-opacity-20 transition-all duration-500"></div>
    </div>

    <!-- Suggest Data Modal - Town Selection -->
    <div id="suggestDataModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900" data-i18n="suggestData.title">Suggest New Data</h2>
                    <button id="closeSuggestModal" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">
                        ×
                    </button>
                </div>
                
                <div class="space-y-6">
                    <!-- Step Indicator -->
                    <div class="flex items-center gap-2 mb-6">
                        <div class="flex-1 flex items-center">
                            <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold">1</div>
                            <div class="flex-1 h-1 bg-blue-600 mx-2"></div>
                        </div>
                        <div class="flex-1 flex items-center">
                            <div class="w-8 h-8 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center font-bold">2</div>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-4" data-i18n="suggestData.step1Description">First, select the town you want to add data for:</p>
                    
                    <!-- Town Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="suggestData.townName">Town Name</label>
                        <input type="text" id="townName" class="w-full px-3 py-2 border border-gray-300 rounded-md" required placeholder="e.g., Jerusalem">
                    </div>
                    
                    <!-- Country Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="suggestData.country">Country</label>
                        <input type="text" id="country" class="w-full px-3 py-2 border border-gray-300 rounded-md" required placeholder="e.g., Israel">
                    </div>
                    
                    <!-- Location Map -->
                    <div id="townLocationMap" style="height: 300px; margin: 15px 0;" class="border border-gray-300 rounded-md">
                        <div class="flex items-center justify-center h-full text-gray-500" data-i18n="suggestData.searchingLocation">Searching location...</div>
                    </div>
                    
                    <div id="locationConfirmation" class="hidden bg-blue-50 border border-blue-200 rounded-md p-4">
                        <p class="text-blue-800 font-semibold" data-i18n="suggestData.confirmLocation">Please confirm the location:</p>
                        <p class="text-sm text-gray-600 mb-3" id="locationDetails"></p>
                        <p class="text-xs text-gray-500 mb-3">You can drag the red marker to fine-tune the location. Click anywhere else on the map to move it.</p>
                        <div class="flex gap-2">
                            <button type="button" id="confirmLocationBtn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium">
                                ✓ Confirm This Location
                            </button>
                            <button type="button" id="rejectLocationBtn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 font-medium">
                                ✗ Reject & Search Again
                            </button>
                        </div>
                    </div>
                    
                    <!-- Multiple Identifications -->
                    <div id="multipleIdentifications" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="suggestData.selectLocation">Select Correct Location</label>
                        <div id="identificationOptions" class="space-y-2"></div>
                    </div>
                    
                    <!-- Navigation Buttons -->
                    <div class="flex justify-end gap-4 pt-4 border-t">
                        <button type="button" id="cancelSuggestData" class="px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors" data-i18n="ui.cancel">Cancel</button>
                        <button type="button" id="continueToDataEntry" class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" data-i18n="suggestData.continue">Continue</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Entry Modal -->
    <div id="dataEntryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900" data-i18n="suggestData.dataEntryTitle">Add Population Data</h2>
                    <button id="closeDataEntryModal" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">
                        ×
                    </button>
                </div>
                
                <div class="space-y-6">
                    <!-- Step Indicator -->
                    <div class="flex items-center gap-2 mb-6">
                        <div class="flex-1 flex items-center">
                            <div class="w-8 h-8 rounded-full bg-green-600 text-white flex items-center justify-center font-bold">✓</div>
                            <div class="flex-1 h-1 bg-green-600 mx-2"></div>
                        </div>
                        <div class="flex-1 flex items-center">
                            <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold">2</div>
                        </div>
                    </div>
                    
                    <!-- Selected Town Info -->
                    <div class="bg-blue-50 border border-blue-200 rounded-md p-4 mb-4">
                        <p class="text-sm text-gray-600 mb-1" data-i18n="suggestData.selectedTown">Selected Town:</p>
                        <p class="text-lg font-semibold text-blue-900" id="selectedTownInfo"></p>
                    </div>
                    
                    <!-- Form -->
                    <form id="dataEntryForm">
                        <!-- Data Entry Table -->
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="block text-sm font-medium text-gray-700" data-i18n="suggestData.dataEntries">Population Data Entries</label>
                                <button type="button" id="addDataEntry" class="text-blue-600 hover:text-blue-800 text-sm font-medium" data-i18n="suggestData.addEntry">+ Add Entry</button>
                            </div>
                            <div id="dataEntries" class="space-y-2">
                                <!-- Data entries will be added here dynamically -->
                            </div>
                        </div>
                        
                        <!-- Optional Comment -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="suggestData.comment">Comment (Optional)</label>
                            <textarea id="comment" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Any additional information or notes..."></textarea>
                        </div>
                        
                        <!-- User Details -->
                        <div class="border-t pt-4">
                            <h3 class="text-sm font-medium text-gray-700 mb-3" data-i18n="suggestData.yourDetails">Your Details (Optional)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="suggestData.yourName">Your Name</label>
                                    <input type="text" id="yourName" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="John Doe">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="suggestData.yourEmail">Your Email</label>
                                    <input type="email" id="yourEmail" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="john@example.com">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="flex justify-end gap-4 pt-4 border-t">
                            <button type="button" id="backToTownSelection" class="px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors" data-i18n="ui.previous">Back</button>
                            <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors" data-i18n="suggestData.send">Send</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

</body>

</html>